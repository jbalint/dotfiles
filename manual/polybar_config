; -*- mode: conf -*-
; c.f. /usr/share/doc/polybar/config
; https://github.com/polybar/polybar/wiki/Formatting
; ~/.config/polybar% ln -s ~/sw/dotfiles/manual/polybar_config config

[colors]
;https://htmlcolors.com/hex/bd2c40
;background = ${xrdb:color0:#222}
background = #222
background-alt = #444
;foreground = ${xrdb:color7:#222}
foreground = #dfdfdf
foreground-alt = #555
primary = #ffb52a
secondary = #e60053
alert = #bd2c40

[section/base]
;module-margin = 2
module-margin-left = 1
module-margin-right = 2
;modules-center = xwindow bspwm
modules-right = date weather kernel
width = 100%
padding-left = 2
padding-right = 2
height = 20

; line size for underlining - https://github.com/polybar/polybar/issues/1445#issuecomment-425658565
line-size = 1

;border-color = #00000000
;border-left-size = 40
;border-bottom-size = 20

font-0 = "Tamsyn:pixelsize=9;0"
font-1 = "Lohit Hindi"
;font-1 = "Roboto:size=11:weight=bold;2"
;font-2 = "Noto Sans:size=11;1"

background = ${colors.background}
foreground = ${colors.foreground}

fixed-center = true

[bar/camus]
inherit = section/base
monitor = eDP1
modules-left = cpu memory load network_wlp3s0 kodi nightscout battery

[bar/jrussell]
inherit = section/base
monitor = DP-1
modules-left = cpu memory load network_enp109s0f1 kodi nightscout battery bspwm git-monitor russian-alphabet
locale = ru_RU.UTF-8

[bar/tagore]
inherit = section/base
monitor = DP-1
modules-left = cpu memory load filesystem_tagore_home network kodi network nightscout

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; MODULES are in alphabetical order ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

[module/battery]
type = internal/battery
full-at = 99
battery = BAT0
adapter = AC
poll-interval = 60
time-format = %H:%M
format-charging = <label-charging>
format-discharging = <label-discharging>
format-full = <label-full>
label-charging = Charging %percentage%%
label-discharging = Discharging %percentage%%
;label-full = Fully charged
label-full = –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞—Ä—è–∂–µ–Ω–∞

[module/bspwm]
type = internal/bspwm
label-focused = %name%
label-focused-background = ${colors.background-alt}
label-focused-underline= ${colors.primary}
label-focused-padding = 1

label-occupied = %name%
label-occupied-padding = 1

label-urgent = %name%!
label-urgent-background = ${colors.alert}
label-urgent-padding = 1

label-empty = %name%
label-empty-foreground = ${colors.foreground-alt}
label-empty-padding = 1

; Separator in between workspaces
; label-separator = |

pin-workspaces = false

[module/cpu]
type = internal/cpu
interval = 2
format-prefix = "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: "
;format-prefix = "CPU: "
;format-prefix-foreground = ${colors.foreground-alt}
; TODO : when this is set properly, the rest of the bar should not be shifted over when CPU goes from single to double digits
label = %percentage:2%%

[module/date]
type = internal/date
interval = 1
;date = " %a %Y-%m-%d"
; russian_days is a local script to open https://www.babbel.com/en/magazine/how-to-write-the-date-in-russian
date = " %{A1:russian_days:}%A/%a%{A} %Y-%m-%d"
time = %H:%M:%S
label = "%date% %time%"
label-foreground = #dfdfdf
click-left = 

[module/filesystem_tagore_home]
type = internal/fs
mount-0 = /home
format-mounted-prefix = "FS: "
format-mounted-prefix-foreground = ${colors.foreground-alt}
label-mounted = %percentage_used%%
; TODO why don't these work
;click-mount-left = st bash -c "du -Pxh * | sort -h| less +G"
;click-left = st bash -c "du -Pxh * | sort -h| less +G"
interval = 300
;format-mounted-underline = #fe0000

[module/git-monitor]
type = custom/script
exec = $BS_HOME/git_repo_monitor/git_modified_repo_count.sh
click-left = urxvt -hold -e $BS_HOME/git_repo_monitor/./git_monitor_report.sh &
interval = 600
format-underline = #fe0000

[module/kernel]
type = custom/script
exec = uname -r
interval = 1024
label-foreground = #ffc143

[module/kodi]
type = custom/script
exec = /home/jbalint/sw/dotfiles/manual/kodi_shortstat.sh
interval = 5
format-prefix = "KODI: "
format-prefix-foreground = ${colors.foreground-alt}

[module/load]
type = custom/script
exec = awk '{print $1" "$2" "$3}' < /proc/loadavg
interval = 2
format-prefix = "–Ω–∞–≥—Ä—É–∑–∫–∞: "
;format-prefix = "‡§≠‡§æ‡§∞: "
;format-prefix = "LOAD: "
; TODO : no way to set this globally?
;format-prefix-foreground = ${colors.foreground-alt}
click-left = st htop

[module/memory]
type = internal/memory
interval = 2
format-prefix = "–ü–∞–º—è—Ç—å: "
;format-prefix = "MEM: "
;format-prefix-foreground = ${colors.foreground-alt}
format-underline = #fe0000

;; TODO : conditional coloring:
; https://github.com/polybar/polybar/issues/956
; https://github.com/polybar/polybar/issues/570

[section/network_base]
type = internal/network
interface = eno1
format-connected-prefix = "‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï:"
;format-connected-prefix = "NET: "
;format-connected-prefix-foreground = ${colors.foreground-alt}
format-connected = <label-connected>
format-disconnected = <label-disconnected>
format-packetloss = <animation-packetloss> <label-connected>
label-connected = %ifname% [D: %downspeed:9%] [U: %upspeed:9%]
label-connected-foreground = #eefafafa
label-disconnected = not connected
label-disconnected-foreground = #66ffffff
animation-packetloss-0 = ‚ö†
animation-packetloss-0-foreground = #ffa64c
animation-packetloss-1 = üì∂
animation-packetloss-1-foreground = #000000
animation-packetloss-framerate = 500

; tagore
[module/network_eno1]
inherit = section/network_base
interface = eno1

; jrussell
[module/network_wlp110s0]
inherit = section/network_base
interface = wlp110s0
; jrussell
[module/network_enp109s0f1]
inherit = section/network_base
interface = enp109s0f1

; camus
[module/network_wlp3s0]
inherit = section/network_base
interface = wlp3s0

[module/nightscout]
; TODO : conditional colors would be great here too
;        I could put them into the script I guess
type = custom/script
exec = /home/jbalint/sw/java-sw/nightscout-virtual-graph/latest_bg.sh
interval = 120
format-prefix = "—É—Ä–æ–≤–µ–Ω—å —Å–∞—Ö–∞—Ä–∞: "
;format-prefix = "BG: "
;format-prefix-foreground = ${colors.foreground-alt}
click-left = chromium https://jbalint-bg.herokuapp.com

[module/russian-alphabet]
type = custom/text
; in keyboard order
content = "–Å—ë-–ô–π–¶—Ü–£—É–ö–∫–ï–µ–ù–Ω–ì–≥–®—à–©—â–ó–∑–•—Ö–™—ä-–§—Ñ–´—ã–í–≤–ê–∞–ü–ø–†—Ä–û–æ–õ–ª–î–¥–ñ–∂–≠—ç-–Ø—è–ß—á–°—Å–ú–º–ò–∏–¢—Ç–¨—å–ë–±–Æ—é"
; in alphabetical order
;content = "–ê–∞ –ë–± –í–≤ –ì–≥ –î–¥ –ï–µ –Å—ë –ñ–∂ –ó–∑ –ò–∏ –ô–π –ö–∫ –õ–ª –ú–º –ù–Ω –û–æ –ü–ø –†—Ä –°—Å –¢—Ç –£—É –§—Ñ –•—Ö –¶—Ü –ß—á –®—à –©—â –™—ä –´—ã –¨—å –≠—ç –Æ—é –Ø—è"
click-left = xdg-open http://www.russianlessons.net/lessons/lesson1_alphabet.php
click-right = xdg-open https://localhost/mediawiki/index.php/Russian

[module/weather]
type = custom/script
exec = curl -s -o - https://tgftp.nws.noaa.gov/data/observations/metar/decoded/KMSN.TXT | tr '\n' ' ' | perl -lpe's/.*Temperature: (.+?) .*/$1¬∞/'
interval = 600
format-prefix = "MSN: "
format-prefix-foreground = ${colors.foreground-alt}
click-left = chromium https://www.accuweather.com/en/us/madison-wi/53715/weather-radar/331530

[module/xkeyboard]
type = internal/xkeyboard
; tried this but it's showing the opposite layout (when only two are present)

[module/xwindow]
type = internal/xwindow
label = %title:0:30:...%

[global/wm]
margin-top = 0
margin-bottom = 0
margin-left = 30
margin-right = 50
